{"openapi":"3.1.0","info":{"title":"CycleGraph API","version":"0.1.0"},"paths":{"/api/sessions/{sid}/analyze":{"post":{"summary":"Api Analyze","description":"Støtter to datakilder:\n1) Inline timeserie (samples/records) dersom ANALYZE_ALLOW_INLINE=1\n2) Persistert session (tidligere oppførsel)\nFallback: stub-resultat dersom USE_STUB_FALLBACK=1 og ingen data finnes.","operationId":"api_analyze_api_sessions__sid__analyze_post","parameters":[{"name":"sid","in":"path","required":true,"schema":{"type":"string","title":"Sid"}},{"name":"force_recompute","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Force Recompute"}},{"name":"X-CycleGraph-Force","in":"header","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"X-Cyclegraph-Force"}}],"requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/AnalyzeRequest2"},{"type":"null"}],"title":"Body"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/health":{"get":{"summary":"Health","operationId":"health_api_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/sessions/{sid}":{"get":{"summary":"Api Get Session","operationId":"api_get_session_api_sessions__sid__get","parameters":[{"name":"sid","in":"path","required":true,"schema":{"type":"string","title":"Sid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/sessions/{sid}/publish":{"post":{"summary":"Api Publish","operationId":"api_publish_api_sessions__sid__publish_post","parameters":[{"name":"sid","in":"path","required":true,"schema":{"type":"string","title":"Sid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/debug/publish_flags/{sid}":{"get":{"summary":"Debug Flags","operationId":"debug_flags_api_debug_publish_flags__sid__get","parameters":[{"name":"sid","in":"path","required":true,"schema":{"type":"string","title":"Sid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/debug/token_present":{"get":{"summary":"Debug Token Present","operationId":"debug_token_present_api_debug_token_present_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/debug/publish_probe/{sid}":{"get":{"summary":"Debug Publish Probe","operationId":"debug_publish_probe_api_debug_publish_probe__sid__get","parameters":[{"name":"sid","in":"path","required":true,"schema":{"type":"string","title":"Sid"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/timeseries/stub":{"get":{"summary":"Timeseries Stub","operationId":"timeseries_stub_api_timeseries_stub_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/sessions/summary":{"get":{"summary":"Sessions Summary","operationId":"sessions_summary_api_sessions_summary_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/favicon.ico":{"get":{"summary":"Favicon","operationId":"favicon_favicon_ico_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AnalyzeOptions":{"properties":{"force_recompute":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Force Recompute"}},"type":"object","title":"AnalyzeOptions"},"AnalyzeRequest2":{"properties":{"wind_angle_deg":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Wind Angle Deg"},"air_density_kg_per_m3":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Air Density Kg Per M3"},"profile":{"anyOf":[{"$ref":"#/components/schemas/ProfileIn-Input"},{"type":"null"}]},"options":{"anyOf":[{"$ref":"#/components/schemas/AnalyzeOptions"},{"type":"null"}]},"samples":{"anyOf":[{"items":{"$ref":"#/components/schemas/Sample"},"type":"array"},{"type":"null"}],"title":"Samples"},"records":{"anyOf":[{"items":{"$ref":"#/components/schemas/Record"},"type":"array"},{"type":"null"}],"title":"Records"}},"type":"object","title":"AnalyzeRequest2"},"AnalyzeResponse":{"properties":{"ok":{"type":"boolean","title":"Ok","default":true},"session_id":{"type":"string","title":"Session Id"},"metrics":{"$ref":"#/components/schemas/MetricsOut"},"debug":{"$ref":"#/components/schemas/DebugOut"}},"type":"object","required":["session_id","metrics","debug"],"title":"AnalyzeResponse"},"DebugOut":{"properties":{"analyzer_mode":{"type":"string","enum":["series","single","unknown"],"title":"Analyzer Mode","default":"series"},"force_recompute":{"type":"boolean","title":"Force Recompute","default":false},"ignored_persist":{"type":"boolean","title":"Ignored Persist","default":false},"reason":{"type":"string","title":"Reason","default":"ok"}},"type":"object","title":"DebugOut"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"MetricsOut":{"properties":{"precision_watt":{"type":"number","title":"Precision Watt"},"precision_watt_ci":{"type":"number","title":"Precision Watt Ci"},"total_watt":{"type":"number","title":"Total Watt"},"drag_watt":{"type":"number","title":"Drag Watt"},"rolling_watt":{"type":"number","title":"Rolling Watt"},"aero_fraction":{"type":"number","title":"Aero Fraction"},"weather_applied":{"type":"boolean","title":"Weather Applied"},"profile_used":{"$ref":"#/components/schemas/ProfileIn-Output"}},"type":"object","required":["precision_watt","precision_watt_ci","total_watt","drag_watt","rolling_watt","aero_fraction","weather_applied","profile_used"],"title":"MetricsOut"},"ProfileIn-Input":{"properties":{"CdA":{"anyOf":[{"type":"number","maximum":0.6,"minimum":0.15},{"type":"null"}],"title":"Cda"},"Crr":{"anyOf":[{"type":"number","maximum":0.02,"minimum":0.002},{"type":"null"}],"title":"Crr"},"weight_kg":{"anyOf":[{"type":"number","maximum":150.0,"minimum":35.0},{"type":"null"}],"title":"Weight Kg"},"device":{"anyOf":[{"type":"string","enum":["strava","garmin","zwift","unknown"]},{"type":"null"}],"title":"Device","default":"strava"}},"type":"object","title":"ProfileIn"},"ProfileIn-Output":{"properties":{"CdA":{"type":"number","exclusiveMinimum":0.0,"title":"Cda"},"Crr":{"type":"number","exclusiveMinimum":0.0,"title":"Crr"},"weight_kg":{"type":"number","exclusiveMinimum":0.0,"title":"Weight Kg"},"device":{"type":"string","title":"Device"}},"type":"object","required":["CdA","Crr","weight_kg","device"],"title":"ProfileIn"},"Record":{"properties":{"timestamp_ms":{"type":"integer","title":"Timestamp Ms"},"pw":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Pw"},"np":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Np"},"source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"},"calibrated":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Calibrated"}},"type":"object","required":["timestamp_ms"],"title":"Record"},"Sample":{"properties":{"timestamp_ms":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Timestamp Ms","description":"Epoch ms"},"time":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Time","description":"ISO8601Z"},"lat":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Lat"},"lon":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Lon"},"elev":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Elev"},"speed":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Speed"},"hr":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Hr"},"cadence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cadence"},"watts":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Watts"},"temp":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Temp"}},"type":"object","title":"Sample"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}