# Definition of Done â€” Frontlog
*Samlet oversikt over hva som er ferdig, pÃ¥begynt og planlagt. Ikke-sensitive, hÃ¸ynivÃ¥ punkter.*

Sist oppdatert: 2025-09-09

---

## âœ… FERDIG

### M1 â€” Prosjektstruktur & repo
- Standard repo-oppsett: `core/`, `cli/`, `docs/`, `data/`, `shapes/`, `tests/`.
- Init GitHub-repo (README, lisens, .gitignore).
- Bygg/kjÃ¸rbare grunnkommandoer dokumentert i README (Rust/Python).
- CI eller lokal â€œquick checkâ€: `cargo check` og enkel Python-kall fungerer.

### M2 â€” Rust-core med PyO3
- Cargo.toml satt opp med PyO3 av riktig versjon.
- Minst Ã©n eksponert Rust-funksjon bundet til Python (importerbar i Python).
- `cargo test` (grunnleggende) og â€œimport i Pythonâ€ fungerer lokalt.
- Kodekommentarer: hvor core-API lever og hvordan bygge.

### M3 â€” CLI-oppsett & dataflyt
- `cli/analyze.py` kjÃ¸rer ende-til-ende mot core (Rust) med argparse-flagg.
- I/O-kontrakt: leser CSV/streams, skriver rapport/JSON til `output/`.
- Grunnleggende feilhÃ¥ndtering (fil mangler, feil format) med tydelige feilmeldinger.
- â€œHappy pathâ€ demonstrert pÃ¥ sample data.

### M4 â€” Dummydata & testkjÃ¸ring
- Dummy/samples tilgjengelig i repo (ikke sensitive).
- KjÃ¸reeksempel dokumentert: `python -m cli.analyze ...` produserer forutsigbar rapport.
- Sanity-sjekk: verdier i rapport er konsistente og uten exceptions.
- Enkle tester/skript verifiserer flyten.

### M5 â€” SHACL-validering
- SHACL-shapes for RDF definert i `shapes/`.
- Valideringsscript i Python: kjÃ¸rbar via CLI-flag eller separat kommando.
- Eksempelfiler validerer OK; feil rapporteres forstÃ¥elig.
- Kort bruksdokumentasjon i `docs/` (hva, hvordan, hvor output havner).

### M6 â€” Strava-integrasjon (API & import)
- OAuth-flyt verifisert; tokens lagres sikkert lokalt (ingen hemmeligheter i repo).
- Henting av aktiviteter med paging og tidsfilter (`--since`) fungerer.
- Streams â†’ CSV (minst `time,hr,watts`), robust hÃ¥ndtering av 401/403/429/5xx.
- Inkrementell state (ingen duplikater), og grunnlogg over kjÃ¸ringer.
- End-to-end â€œimport â†’ analyzeâ€ fungerer pÃ¥ â‰¥3 reelle Ã¸kter (lokalt verifisert).



### M7.5 â€” GitHub Actions (CI)
- Workflow for Ã¥ bygge PyO3, kjÃ¸re `cargo test` (inkl. golden) og `scripts/system_test.sh`.
- Akseptanse: grÃ¸nn kjÃ¸ring pÃ¥ push/PR, systemtest fullfÃ¸rt uten feil.

### M7 â€” Analysefunksjoner (effektivitet, treningsscore)
- CGS v1 etablert: IF/NP/VI/Pa:Hr/WpB + 28d baseline (Â±25 %), tydelige fallbacks.
- Badges: Big Engine (+6 %, â‰¥30 min) og Metronome (VIâ‰¤1.05, Pa:Hrâ‰¤1.05).
- Python: Strava publish-formatter m/ sprÃ¥k, trimming og fallbacks + tester grÃ¸nne.
- Rust: unit + golden + perf-guard (2h@1Hz â‰¤200 ms) grÃ¸nne.
- Strava-klient: auto-refresh, header-fix, commentâ†’description-fallback, verifisert live.
- Docs: CGS_v1, CLI usage, Strava publish oppdatert.

### M7.5 â€” Backend-forfining (CGS v1.1, explain)
- Systemtest grÃ¸nn pÃ¥ steg 0â€“7: PyO3-import, CLI-hjelp, E2E med sample, idempotens, feilhÃ¥ndtering, Rust/golden, perf-smoke (~0.73s).
- SHACL- og Strava-mock-test kan hoppes nÃ¥r ingen `.ttl` eller mock-data er tilgjengelig.
- Fikser gjort: ryddet `cmd_session`, fikset `continue`-feil, lagt til `mod metrics;` i `lib.rs` (lÃ¸ste E0432), output verifisert deterministisk.

### M7.5 â€” Forebyggende tester
- Pytest: `_analyze_session_bridge()` kaster `ValueError` ved tomme arrays.
- Rust golden-test for `w_per_beat()` med edge-case input (NaN/null/mismatch).
- Branch: `feature/m7.5-preventive-tests`
- Tester grÃ¸nne: `pytest` + `cargo test` (inkl. golden).
- Observasjoner: `w_per_beat()` hÃ¥ndterer NaN/mismatch robust; logging/Result kan vurderes senere.

---

## ğŸŸ¡ PÃ…BEGYNT
*(ingen Ã¥pne oppgaver her nÃ¥)*---

## ğŸ”œ PLANLAGT (IKKE STARTET)

### M7.6 â€” Watt-engine v1 (backend klar)
- Implementere wattberegning v1 med vÃ¦rdata og sykkeltype som input.
- Utvide Rust-funksjonene, teste med golden tests + live Ã¸kter.
- Perf-sjekk (idempotens, kaldstart < 3s).
- DoD-punkt: oppdater **CGS score** til v1.1 nÃ¥r implementasjonen fungerer og er testet.

###Hva - Legge til parameter for treningsmodus (`--mode roller|outdoor`) i CLI/backend.
  - Roller: bruk watt fra rulle, hopp over vÃ¦rdata.
  - Outdoor: aktiver beregning med vÃ¦rdata, sykkeltype og terreng.
- Akseptanse: 
  - CLI stÃ¸tter `--mode` flagg.
  - Systemtest viser forskjell i output (vÃ¦rdata kun brukt ved `--mode outdoor`).
  - Idempotens og golden tests grÃ¸nne for begge moduser.

### M8 â€” Demo & visualisering
- Enkel frontend/webdemo som viser nÃ¸kkelmetrikker (NP, IF, VI, Pa:Hr, W/slag, CGS, CGS-Watt v1) for Ã©n Ã¸kt.
- Integrasjon mot CLI-output, rapporter og eventuelt Strava publish (dry-run fÃ¸rst).
- Skal gi reell verdi for syklist og fungere som fÃ¸rste MVP/demo.

---

### Notater
- Sensitive nÃ¸kler, ekte tokens og personlige data holdes utenfor repoet.
- Denne DoD-listen er bevisst sanert og hÃ¸ynivÃ¥ for offentlig deling.
- Strukturen â€œFerdig / PÃ¥begynt / Planlagtâ€ gir bÃ¥de frontlog og backlog i ett.


